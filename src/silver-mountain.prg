LET EL=39:LET NO=88:LET NV=57:LET G=28
GOSUB 3380
GOSUB 4400
LET LL=0
GOSUB 3310
LET P$=X$(VAL(LEFT$(D$,1)))+" "+Y$(VAL(MID$(D$,2,1)))+" "
LET J$=R$+", "+"YOU ARE "+P$+RIGHT$(D$,LEN(D$)-2)+" ":GOSUB 4830
GOSUB 3330:LET J$=""
FOR I=1 TO G-1
READ O$
LET P$=Y$(VAL(LEFT$(O$,1))):GOSUB 3350
IF F(I)=0 AND C(I)=R THEN LET J$=J$+" "+P$+" "+O$+","
NEXT I
IF R=29 AND F(48)=0 THEN LET J$=J$+" GRARGS FEASTING,"
IF R=29 AND F(48)=1 THEN LET J$=J$+" A SLEEPING GRARG,"
IF R=12 AND OR R="" THEN LET J$=J$+" A PONY,"
IF R=64 THEN LET J$=J$+" A HERMIT,"
IF R=18 AND E$(18)="N" THEN LET J$=J$+" AND OAK DOOR,"
IF R=59 AND F(68)=1 THEN LET J$=J$+" OGBAN (DEAD),"
IF J$<>"" THEN LET J$=", YOU CAN SEE"+J$
LET J$=J$+" AND YOU CAN GO "
GOSUB 4830:PRINT " ";
FOR I=1 TO LEN(E$(R)):PRINT MID$(E$(R),I,1);",";
NEXT I:PRINT:PRINT:
NEXT R$="PARDON?":PRINT "===================="
PRINT:PRINT:PRINT "WHAT WILL YOU DO NOW "P
INPUT I$
IF I$="SAVE GAME" THE GOTO 4630
LET V$="":LET T$="":LET VB=0:LET B=0
FOR I=1 TO LEN(I$)
IF MID$(I$,I,1)=" " AND V$="" THEN LET V$=LEFT$(I$,I-1)
IF MID$(I$,I+1,1)<>" " AND V$<>"" THE LET T$=MID$(I$,I+1,LEN(I$)-1):LET I=LEN(I$)
NEXT I:IF T$="" THEN LET V$=I$
IF LEN(V$)<3 THEN LET V$=V$+"0":GOTO 340
IF V$="PLAY" THEN LET V$="BLO"
LET U$=LEFT$(V$,3)
OFR I=1 TO NV:IF MID$(B$, I*3-2,3)=U$ THEN LET VB=I:LET I=NV
NEXT I:LET F(36)=0
GOSUB 3330
FOR I=1 TO NO:READ O$: IF I<=G THEN GOSUB 3350
IF T$=O$ THEN LET B=I:LET I=NO
NEXT I
IF B=0 AND F(36)=0 AND T$>"" THEN LET T$=T$+"S":LET F(36)=1:GOTO 390
IF VB=0 THEN LET VB=NV+1
IF T$="" THEN LET R$="I NEED TWO WORDS"
IF VB>NV THEN LET R$="TRY SOMETHING ELSE"
IF VB>NV AND B=0 THEN LET R$="YOU CANNOT "+I$
IF B>G OR B>0 THEN GOTO 510
IF VB=8 OR VB=9 OR VB=14 OR VB=17 OR VB=44 OR VB>54 GOTO 510
IF VB<NV AND C(B)<>0 THEN LET R$="YOU DO NOT HAVE THE "+T$:GOTO 30
IFR=56ANDF(35)=0ANDVB<>37ANDVB<>53THENR$=X1$+" HAS GOT YOU!":GOTO30
IF VB=44 OR VB=47 OR VB=19 OR VB=57 OR VB=49 THEN GOTO 540
IF R=48 AND F(63)=0 THEN LET R$=X9$:GOTO 30
LET H=VAL(STR$(R)+STR$(B))
ON INT((VB-1)/13)+1 GOTO 560,580,600,620,640
ON VB GOSUB 800,800,800,800,800,800,1220,1290,1470,1470,1750,1890
GOTO 650
ONVB-13GOSUB1960,1980,2010,3050,2870,2120,2220,2310,2380,2420,2450,2470,2520
GOTO 650
ONVB-26GOSUB2550,2580,2610,2650,2670,2700,2720,2730,2830,2800,2870,2730,2920
GOTO 650
ONVB-39GOSUB2950,2990,3010,3050,3070,2310,2990,3070,3130,2120,3190,1470,3100
GOTO 650
ON VB-52 GOSUB 2870,3150,1290,1290,3170,3200
IF F(62)=1 THEN GOTO 730
IF R=41 THEN LET F(67)=F(67)+1:IF F(67)=10 THEN LET F(56)=1:LET R$="YOU SANK!"
IF R=56 AND F(35)=0 AND C(10)<>0 THEN LET R$X1$+" GETS YOU!":LET F(56)=1
IF F(56)=0 THEN GOTO 30
GOSUB 4400:PRINT R$
PRINT "YOU HAVE FAILED IN YOUR QUEST!"
PRINT:PRINT "BUT YOU ARE GRANTED ANOTHER TRY"
GOSUB 3360:RUN
GOSUB 4400
PRINT "HOOOOOOOOORRRRRRAAAAAAAAYYYYY!"
PRINT
PRINT "YOU HAVE SUCCEDED IN YOUR"
PRINT "QUEST AND BROUGHT PEACE TO"
PRINT "THE LAND"
STOP
LET D=VB
IF D=5 THEN LET D=1
IF D=6 THEN LET D=3
IF NOT ((R=75 AND D=2) OR (R=76 AND D=4)) OR F(64)=1 THEN GOTO 850
LET R$="B USPMM TUPQT ZPV DSPTTJOH":GOSUB 4260:RETURN
IF F(64)=1 THEN LET F(64)=0
IF F(51)=1 OR F(29)=1 THEN GOTO 900
IF F(55)=1 THEN LET F(56)=1:LET R$"GRARGS HAVE GOT YOU!":RETURN
IF R=29 AND F(48)=0 THEN LET R$="GRARGS WILL SEE YOU!":RETURN
IF R=73 OR R=42 OR R=9 OR R=10 THEN LET R$=X3$:LET F(55)=1:RETURN
IF C(8)=0AND((R=52ANDD=2)OR(R=31ANDD<>3))THENLETR$="THE BOAT IS TOO HEAVY":RET
IFC(8)<>0AND((R=52ANDD=4)OR(R=31ANDD=3))THENLETR$="YOU CANNOT SWIM":RETURN
IF R=52 AND C(8)=0 AND D=4 AND F(30)=0 THEN LET R$="NO POWER!":RETURN
IF R=41 AND D=3 AND F(31)=0 THEN LET R$="UIF CPBU JT TJOLJOH!":GOSUB 4260:RETURN
IF R=33 AND D=1 AND F(32)=0 THEN LET R$="OGBAN'S BOAR BLOCKS YOUR PATH":RETURN
IF ((R=3 AND D=2) OR (R=4 AND D=4)) AND F(45)= THEN LET R$=X5$:RETURN
IF R=35 AND C(13)<>R THEN LET R$="THE ICE IS BREAKING!":RETURN
IF R=5 AND (D=2 OR D=4) THEN GOSUB 4310
IF R=4 AND D=4 THEN LET R$="PASSAGE IS TOO STEEP":RETURN
IF R=7 AND D=2 AND F(46)=0 THEN LET R$="A HUGE HOUND BARS YOUR WAY":RETURN
IF (R=38 OR R=37) AND F(50)=0 THEN LET R$="JU JT UPP EBSL":GOSUB 4260:RETURN
IFR=49AND3=2ANDF(54)=0THENLETR$="MYSTERIOUS FORCES HOLD YOU BACK":RETURN
IF R=49 AND D=3 AND F(68)=0 THEN LET R$="YOU MET OGBAN!!!":LET F(56)=1:RETURN
IF R=38 AND F(65)=0 THEN LET R$="RATS NIBBLE YOUR ANKLES":RETURN
IFR=58AND(D=1ORD=4)ANDF(66)=0THENLETR$="YOU GET CAUGHT IN THE WEBS!":RET
IF R=48 AND D=4 AND F(70)=0 THEN LET R$="THE DOOR DOES NOT OPEN":RETURN
IF R=40 AND F(47)=1 THEN LET F(68)=1
IFR=37ANDD=4ANDE$(37)="EW"THENLETR=67:LET R$="THE PASSAGE WAS STEEP!":RETURN
IF R=29 AND D=3 THEN LET F(48)=1:LET F(20)=0
IF R=8 AND D=2 THEN LET F(46)=0
LET OM=R:FOR I=1 TO LEN(E$(R))
LET K$=MID$(E$(OM),I,1)
IF (K$="N" OR K$="U") AND D=1 THEN LET R=R-10
IF K$="E" AND D=2 THEN LET R=R+1
IF (K$="S" OR K$="D") AND D=3 THEN LET R=R+10
IF K$="W" AND D=4 THEN LET R=R-1
NEXT I:LET R$="OK"
IF R=OM THEN LET R$="YOU CANNOT GO THAT WAY"
IF ((OM=75 AND D=2) OR (OM=76 AND D=4)) THEN LET R$="OK, YOU CROSSED"
IF F(29)=1 THEN LET F(39)=F(39)+1
IFF(39)>5ANDF(29)=1THENLETR$="CPPUT IBWF XPSO PVU":GOSUB4260:LETF(29)=0:C(3)=81
RETURN
GOSUB 3330:LET R$="OK":LET F(49)=0
PRINT "YOU HAVE ";
FOR I=1 TO G:READ O$:GOSUB 3350:IF I=1 AND C(1)=0 AND F(44)=1 THEN LET O$="COIN"
IF I=G AND C(5)=0 THEN GOTO 1270
IF C(I) THEN PRINT O$;",";:LET F(49)=1
NEXT I:IF F(49)=0 THEN PRINT "NOTHING"
PRINT:GOSUB 3360:RETURN
IF H=6577 THEN LET R$="HOW?":RETURN
IF H=4177 OR H=5177 THEN LET B=16:GOSUB 2380:RETURN
IF B=38 THEN LET R$="TOO HEAVY!":RETURN
IF B=4 AND F(43)=0 THEN LET R$="IT IS FIRMLY NAILED ON!":RETURN
LET CO=0:FOR I=1 TO G-1:IF C(I)=0 THEN LET CO=CO+1
NEXT I:IF CO>13 THEN LET R$="YOU CANNOT CARRY ANY MORE":RETURN
IF B>G THEN LET R$="YOU CANNOT GET THE "+T$:RETURN
